<!DOCTYPE html>
<html>
<head>
	<title></title>
	<style type="text/css">
		#compass{
    		border-radius: 50%;
		}
	</style>
</head>
<body>

<img src="https://lh3.googleusercontent.com/bGUeJS-wGdOnZNwGSv0Mxztth6hTaV6K5kMsysSLpaVbNnsC4ghu_Vb8qBmeCZ3Dne2H" width="100" height="100" id="compass">
<p>X reading<span id="xreading"></span></p>
<p>Y reading<span id="yreading"></span></p>
<p>Z reading<span id="zreading"></span></p>
<p>D reading<span id="dreading"></span></p>
<script>
let sensor = new Magnetometer();
sensor.start();
sensor.onreading = () => {
    document.getElementById('xreading').innerHTML = sensor.x;
    document.getElementById('yreading').innerHTML = sensor.y;
    document.getElementById('zreading').innerHTML = sensor.z;
    // alert("Magnetic field along the X-axis " + sensor.x);
    // alert("Magnetic field along the Y-axis " + sensor.y);
    // alert("Magnetic field along the Z-axis " + sensor.z);

    xGaussData = sensor.x * 0.48828125;
	yGaussData = sensor.y * 0.48828125;

	d = Math.atan(yGaussData/xGaussData) * (180/Math.PI);

	if (d > 360) d -= 360;
	if (d < 0) d += 360;

    compass = document.getElementById('compass');
    compass.style.transform = "rotate("+d+"deg)";


    document.getElementById('dreading').innerHTML = d;
};

sensor.onerror = event => alert(event.error.name, event.error.message);
</script>
</body>
</html>
